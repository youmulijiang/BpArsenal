# 配置持久化功能测试说明

## 实现的功能

### 1. 用户目录配置文件管理
- **用户配置目录**: `~/.bparsenal/`
- **用户配置文件**: `~/.bparsenal/config.json`
- **首次使用**: 自动从resources/config.json复制默认配置到用户目录
- **后续使用**: 从用户目录加载配置

### 2. 配置持久化
- **工具添加/修改**: 自动保存到用户配置文件
- **配置导入**: 导入外部配置文件并保存到用户目录  
- **配置导出**: 将当前配置导出到指定位置
- **配置重置**: 恢复到resources/config.json的默认配置

### 3. 核心修改点

#### ConfigManager.java
- 新增用户目录配置文件管理
- 实现配置的保存、导入、导出、重置功能
- 确保配置目录存在

#### ToolController.java  
- 修改saveConfiguration()方法调用ConfigManager.saveConfig()
- 确保所有工具操作后都会保存配置

#### SettingPanelController.java
- 更新配置管理方法使用新的ConfigManager方法
- 简化导入、导出、重置逻辑

#### SettingPanel.java
- 修复硬编码文本，使用国际化

## 解决的问题

1. **配置丢失**: 用户添加的工具重启后不再丢失
2. **持久化存储**: 配置保存在用户目录，独立于插件文件
3. **配置管理**: 支持导入、导出、重置功能
4. **首次体验**: 自动初始化默认配置

## 测试场景

### 场景1: 首次安装使用
1. 安装插件
2. 启动Burp Suite
3. 验证`~/.bparsenal/config.json`文件是否创建
4. 验证配置是否从resources复制

### 场景2: 添加工具持久化
1. 在HTTP工具面板添加新工具
2. 重启Burp Suite
3. 验证新添加的工具是否还存在

### 场景3: 配置重置
1. 在设置面板点击"重置配置"
2. 验证配置恢复到默认状态
3. 验证用户目录配置文件被重置

### 场景4: 配置导入导出
1. 导出当前配置
2. 修改配置
3. 导入之前导出的配置
4. 验证配置是否正确恢复

## 文件结构

```
~/.bparsenal/
└── config.json          # 用户配置文件

项目结构:
src/main/resources/
└── config.json          # 默认配置模板
```

## 兼容性

- 向后兼容旧版本配置格式
- 自动升级配置文件结构
- 错误恢复机制：配置损坏时使用默认配置
